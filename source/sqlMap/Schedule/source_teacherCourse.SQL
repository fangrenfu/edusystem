SELECT row_number() over(order by SCHEDULE.COURSENO) as row,SCHEDULE.COURSENO+SCHEDULE.[GROUP] AS COURSE,TIMESECTIONS.[VALUE] as jc,OEWOPTIONS.NAME as dsz,
SCHEDULE.DAY,SCHEDULE.TIME,SCHEDULE.OEW,SCHEDULE.WEEKS,OEWOPTIONS.TIMEBIT&TIMESECTIONS.TIMEBITS2 AS TIMES ,TEACHERPLAN.TEACHERNO
FROM SCHEDULE JOIN TEACHERPLAN
ON SCHEDULE.MAP=TEACHERPLAN.RECNO
inner join TIMESECTIONS on TIMESECTIONS.NAME=SCHEDULE.TIME
inner join OEWOPTIONS on OEWOPTIONS.CODE=SCHEDULE.OEW
WHERE SCHEDULE.YEAR=:syear
AND SCHEDULE.TERM=:sterm
AND TEACHERPLAN.TEACHERNO in (SELECT DISTINCT(RTRIM(TEACHERS.TEACHERNO)) AS TEACHERNO
FROM TEACHERS JOIN TEACHERPLAN ON TEACHERS.TEACHERNO=TEACHERPLAN.TEACHERNO
INNER JOIN SCHEDULE ON TEACHERPLAN.RECNO=SCHEDULE.MAP
WHERE TEACHERS.TEACHERNO != '000000' AND SCHEDULE.[YEAR] = :tyear and SCHEDULE.TERM = :tterm )

